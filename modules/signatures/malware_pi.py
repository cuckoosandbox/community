from lib.cuckoo.common.abstracts import Signature

class ModifiesIESettings(Signature):
    name = "malware_PoisonIvy"
    description = "Potential Poison Ivy persistence - Reg-ActiveSetup-Installed Components"
    severity = 2
    categories = ["generic"]
    author = "Benjamin K."

    def run(self, results):
        for registry_key in results["behavior"]["summary"]["keys"]:
            if "Software\\\\Microsoft\\\\Active Setup\\\\Installed Components\\\\" in registry_key:
                self.data.append({"registry_key" : registry_key})
                return True

        return False
